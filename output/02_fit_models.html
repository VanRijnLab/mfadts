<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="data:text/css;charset=utf-8,%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20octicons%2Dlink%3B%0Asrc%3A%20url%28data%3Afont%2Fwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM%2B8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB%2FaFGpk3jaTY6xa8JAGMW%2FO62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v%2Bk%2F0an2i%2BitHDw3v2%2B9%2BDBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3%2FI7AtxEJLtzzuZfI%2BVVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy%2FLt7Kc%2B0vWY%2FgAgIIEqAN9we0pwKXreiMasxvabDQMM4riO%2BqxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw%2Bymhce7vwM9jSqO8JyVd5RH9gyTt2%2BJ%2FyUmYlIR0s04n6%2B7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv%2FocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi%2BW2%2BMjCzMIDApSwvXzC97Z4Ig8N%2FBxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh%2F8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT%2BAEjAwuDFpBmA9KMDEwMCh9i%2Fv8H8sH0%2F4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9%2FlqYwOGZxeUelN2U2R6%2BcArgtCJpauW7UQBqnFkUsjAY%2FkOU1cP%2BDAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl%2BvvmM%2FbyA48e6tWrKArm4ZJlCbdsrxksL1AwWn%2FyBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO%2F%2FsdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd%2F89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF%2B9JOS0nbaaYDCQfwCJ7Au3AHj%2BLO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm%2BEBXuAbHmIMSRMs%2B4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL%2BhD7C1xoaHeLJSEao0FEW14ckxC%2BTU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13%2F%2Blm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl%2B9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O%2FAdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB%2F%2F%2FAA8AAQAAAAAAAAAAAAAAAAABAAAAAA%3D%3D%29%20format%28%27woff%27%29%3B%0A%7D%0Abody%20%7B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0Atext%2Dsize%2Dadjust%3A%20100%25%3B%0Acolor%3A%20%23333%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20%22Segoe%20UI%22%2C%20Arial%2C%20freesans%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E6%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Aa%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0A%7D%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0Aoutline%3A%200%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202em%3B%0Amargin%3A%200%2E67em%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%7D%0Ahr%20%7B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Aheight%3A%200%3B%0A%7D%0Apre%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%2C%0Akbd%2C%0Apre%20%7B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ainput%20%7B%0Acolor%3A%20inherit%3B%0Afont%3A%20inherit%3B%0Amargin%3A%200%3B%0A%7D%0Ahtml%20input%5Bdisabled%5D%20%7B%0Acursor%3A%20default%3B%0A%7D%0Ainput%20%7B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Apadding%3A%200%3B%0A%7D%0Atable%20%7B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0Atd%2C%0Ath%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2A%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Ainput%20%7B%0Afont%3A%2013px%20%2F%201%2E4%20Helvetica%2C%20arial%2C%20nimbussansl%2C%20liberationsans%2C%20freesans%2C%20clean%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%234078c0%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200%3B%0Amargin%3A%2015px%200%3B%0Aoverflow%3A%20hidden%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0Ahr%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ahr%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%2015px%3B%0Amargin%2Dbottom%3A%2015px%3B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2030px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2021px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011px%3B%0A%7D%0Ablockquote%20%7B%0Amargin%3A%200%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aol%20ol%2C%0Aul%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Droman%3B%0A%7D%0Aul%20ul%20ol%2C%0Aul%20ol%20ol%2C%0Aol%20ul%20ol%2C%0Aol%20ol%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Dalpha%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0Afont%3A%2012px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0A%7D%0A%2Eselect%3A%3A%2Dms%2Dexpand%20%7B%0Aopacity%3A%200%3B%0A%7D%0A%2Eocticon%20%7B%0Afont%3A%20normal%20normal%20normal%2016px%2F1%20octicons%2Dlink%3B%0Adisplay%3A%20inline%2Dblock%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Drendering%3A%20auto%3B%0A%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3B%0A%2Dmoz%2Dosx%2Dfont%2Dsmoothing%3A%20grayscale%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%0A%7D%0A%2Eocticon%2Dlink%3Abefore%20%7B%0Acontent%3A%20%27%5Cf05c%27%3B%0A%7D%0A%2Emarkdown%2Dbody%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%20%21important%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%20%21important%3B%0A%7D%0Aa%3Anot%28%5Bhref%5D%29%20%7B%0Acolor%3A%20inherit%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Eanchor%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%2Dright%3A%202px%3B%0Amargin%2Dleft%3A%20%2D18px%3B%0A%7D%0A%2Eanchor%3Afocus%20%7B%0Aoutline%3A%20none%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%201em%3B%0Amargin%2Dbottom%3A%2016px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%201%2E4%3B%0A%7D%0Ah1%20%2Eocticon%2Dlink%2C%0Ah2%20%2Eocticon%2Dlink%2C%0Ah3%20%2Eocticon%2Dlink%2C%0Ah4%20%2Eocticon%2Dlink%2C%0Ah5%20%2Eocticon%2Dlink%2C%0Ah6%20%2Eocticon%2Dlink%20%7B%0Acolor%3A%20%23000%3B%0Avertical%2Dalign%3A%20middle%3B%0Avisibility%3A%20hidden%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%2C%0Ah2%3Ahover%20%2Eanchor%2C%0Ah3%3Ahover%20%2Eanchor%2C%0Ah4%3Ahover%20%2Eanchor%2C%0Ah5%3Ahover%20%2Eanchor%2C%0Ah6%3Ahover%20%2Eanchor%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah2%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah3%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah4%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah5%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah6%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%20%7B%0Avisibility%3A%20visible%3B%0A%7D%0Ah1%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%202%2E25em%3B%0Aline%2Dheight%3A%201%2E2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah1%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah2%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%201%2E75em%3B%0Aline%2Dheight%3A%201%2E225%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah2%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%201%2E43%3B%0A%7D%0Ah3%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E25em%3B%0A%7D%0Ah4%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah5%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%201em%3B%0Acolor%3A%20%23777%3B%0A%7D%0Ah6%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ap%2C%0Ablockquote%2C%0Aul%2C%0Aol%2C%0Adl%2C%0Atable%2C%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%204px%3B%0Apadding%3A%200%3B%0Amargin%3A%2016px%200%3B%0Abackground%2Dcolor%3A%20%23e7e7e7%3B%0Aborder%3A%200%20none%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%2Dleft%3A%202em%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%3Ep%20%7B%0Amargin%2Dtop%3A%2016px%3B%0A%7D%0Adl%20%7B%0Apadding%3A%200%3B%0A%7D%0Adl%20dt%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%2016px%3B%0Afont%2Dsize%3A%201em%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adl%20dd%20%7B%0Apadding%3A%200%2016px%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%2015px%3B%0Acolor%3A%20%23777%3B%0Aborder%2Dleft%3A%204px%20solid%20%23ddd%3B%0A%7D%0Ablockquote%3E%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Ablockquote%3E%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Atable%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Aoverflow%3A%20auto%3B%0Aword%2Dbreak%3A%20normal%3B%0Aword%2Dbreak%3A%20keep%2Dall%3B%0A%7D%0Atable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Atable%20th%2C%0Atable%20td%20%7B%0Apadding%3A%206px%2013px%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20tr%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ccc%3B%0A%7D%0Atable%20tr%3Anth%2Dchild%282n%29%20%7B%0Abackground%2Dcolor%3A%20%23f8f8f8%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%3B%0Apadding%2Dtop%3A%200%2E2em%3B%0Apadding%2Dbottom%3A%200%2E2em%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%2085%25%3B%0Abackground%2Dcolor%3A%20rgba%280%2C0%2C0%2C0%2E04%29%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%3Abefore%2C%0Acode%3Aafter%20%7B%0Aletter%2Dspacing%3A%20%2D0%2E2em%3B%0Acontent%3A%20%22%5C00a0%22%3B%0A%7D%0Apre%3Ecode%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Aword%2Dbreak%3A%20normal%3B%0Awhite%2Dspace%3A%20pre%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Ehighlight%20%7B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0A%2Ehighlight%20pre%2C%0Apre%20%7B%0Apadding%3A%2016px%3B%0Aoverflow%3A%20auto%3B%0Afont%2Dsize%3A%2085%25%3B%0Aline%2Dheight%3A%201%2E45%3B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Ehighlight%20pre%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aword%2Dbreak%3A%20normal%3B%0A%7D%0Apre%20%7B%0Aword%2Dwrap%3A%20normal%3B%0A%7D%0Apre%20code%20%7B%0Adisplay%3A%20inline%3B%0Amax%2Dwidth%3A%20initial%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20initial%3B%0Aline%2Dheight%3A%20inherit%3B%0Aword%2Dwrap%3A%20normal%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0Apre%20code%3Abefore%2C%0Apre%20code%3Aafter%20%7B%0Acontent%3A%20normal%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%2Dsize%3A%2011px%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Epl%2Dc%20%7B%0Acolor%3A%20%23969896%3B%0A%7D%0A%2Epl%2Dc1%2C%0A%2Epl%2Ds%20%2Epl%2Dv%20%7B%0Acolor%3A%20%230086b3%3B%0A%7D%0A%2Epl%2De%2C%0A%2Epl%2Den%20%7B%0Acolor%3A%20%23795da3%3B%0A%7D%0A%2Epl%2Ds%20%2Epl%2Ds1%2C%0A%2Epl%2Dsmi%20%7B%0Acolor%3A%20%23333%3B%0A%7D%0A%2Epl%2Dent%20%7B%0Acolor%3A%20%2363a35c%3B%0A%7D%0A%2Epl%2Dk%20%7B%0Acolor%3A%20%23a71d5d%3B%0A%7D%0A%2Epl%2Dpds%2C%0A%2Epl%2Ds%2C%0A%2Epl%2Ds%20%2Epl%2Dpse%20%2Epl%2Ds1%2C%0A%2Epl%2Dsr%2C%0A%2Epl%2Dsr%20%2Epl%2Dcce%2C%0A%2Epl%2Dsr%20%2Epl%2Dsra%2C%0A%2Epl%2Dsr%20%2Epl%2Dsre%20%7B%0Acolor%3A%20%23183691%3B%0A%7D%0A%2Epl%2Dv%20%7B%0Acolor%3A%20%23ed6a43%3B%0A%7D%0A%2Epl%2Did%20%7B%0Acolor%3A%20%23b52a1d%3B%0A%7D%0A%2Epl%2Dii%20%7B%0Abackground%2Dcolor%3A%20%23b52a1d%3B%0Acolor%3A%20%23f8f8f8%3B%0A%7D%0A%2Epl%2Dsr%20%2Epl%2Dcce%20%7B%0Acolor%3A%20%2363a35c%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dml%20%7B%0Acolor%3A%20%23693a17%3B%0A%7D%0A%2Epl%2Dmh%2C%0A%2Epl%2Dmh%20%2Epl%2Den%2C%0A%2Epl%2Dms%20%7B%0Acolor%3A%20%231d3e81%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmq%20%7B%0Acolor%3A%20%23008080%3B%0A%7D%0A%2Epl%2Dmi%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0A%2Epl%2Dmb%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmd%20%7B%0Abackground%2Dcolor%3A%20%23ffecec%3B%0Acolor%3A%20%23bd2c00%3B%0A%7D%0A%2Epl%2Dmi1%20%7B%0Abackground%2Dcolor%3A%20%23eaffea%3B%0Acolor%3A%20%2355a532%3B%0A%7D%0A%2Epl%2Dmdr%20%7B%0Acolor%3A%20%23795da3%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmo%20%7B%0Acolor%3A%20%231d3e81%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%3A%2011px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20%7B%0Alist%2Dstyle%2Dtype%3A%20none%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%2B%2Etask%2Dlist%2Ditem%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20input%20%7B%0Amargin%3A%200%200%2E35em%200%2E25em%20%2D1%2E6em%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0A%3Achecked%2B%2Eradio%2Dlabel%20%7B%0Az%2Dindex%3A%201%3B%0Aposition%3A%20relative%3B%0Aborder%2Dcolor%3A%20%234078c0%3B%0A%7D%0A%2EsourceLine%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0A%7D%0Acode%20%2Ekw%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Edt%20%7B%20color%3A%20%23ed6a43%3B%20%7D%0Acode%20%2Edv%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ebn%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Efl%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ech%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Est%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eco%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Eot%20%7B%20color%3A%20%230086b3%3B%20%7D%0Acode%20%2Eal%20%7B%20color%3A%20%23a61717%3B%20%7D%0Acode%20%2Efu%20%7B%20color%3A%20%2363a35c%3B%20%7D%0Acode%20%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%0Acode%20%2Ewa%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ecn%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Esc%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Evs%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Ess%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eim%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eva%20%7Bcolor%3A%20%23008080%3B%20%7D%0Acode%20%2Ecf%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eop%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ebu%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eex%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Epp%20%7B%20color%3A%20%23999999%3B%20%7D%0Acode%20%2Eat%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Edo%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Ean%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ecv%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ein%20%7B%20color%3A%20%23008080%3B%20%7D%0A" rel="stylesheet">
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="fit-memory-models">Fit memory models</h1>
<p>Maarten van der Velde<br />
Last updated: 2022-05-06</p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#setup">Setup</a>
<ul>
<li><a href="#model-fitting-setup">Model fitting setup</a></li>
<li><a href="#data-setup">Data setup</a></li>
</ul></li>
<li><a href="#fit-model">Fit model</a>
<ul>
<li><a href="#optimal-retrieval-threshold">Optimal retrieval threshold</a>
<ul>
<li><a href="#short-intervals-only">Short intervals only</a></li>
</ul></li>
<li><a href="#optimal-activation">Optimal activation</a></li>
<li><a href="#optimal-decay">Optimal decay</a></li>
<li><a href="#optimal-scaling-factor-h">Optimal scaling factor h</a></li>
</ul></li>
<li><a href="#session-info">Session info</a></li>
</ul>
<h1 id="overview">Overview</h1>
<p>This code fits the ACT-R memory model to the retrieval practice data. We vary which parameter is tuned and which are kept constant, as well as the number of windows in which the data are split before we fit the model.</p>
<p>The model as we use it here consists of two functions:</p>
<ul>
<li><strong>Activation</strong>: <em>A</em> = ln (∑<sub><em>j</em></sub>(<em>t</em><sub>*w**j<em></sub>+</em>h<em>*</em>t<em><sub></em>b<em></sub>)<sup>−</em>d<em></sup>)<br>Parameters: scaling factor </em>h* and decay <em>d</em>. Here, <em>t</em><sub>*w**j<em></sub> refers to within-session intervals and </em>t<em><sub></em>b*</sub> to between-session intervals.</li>
<li><strong>Recall probability</strong>: $p = \frac{1}{1 + e^{-(A - \tau)/s}}$<br>Parameters: retrieval threshold <em>τ</em> (and activation noise <em>s</em>, which we don't vary here).</li>
</ul>
<h1 id="setup">Setup</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table)
<span class="kw">library</span>(purrr)
<span class="kw">library</span>(furrr)

<span class="kw">source</span>(<span class="st">&quot;00_helper_funs.R&quot;</span>)

future<span class="op">::</span><span class="kw">plan</span>(<span class="st">&quot;multiprocess&quot;</span>, <span class="dt">workers =</span> <span class="dv">6</span>) <span class="co"># Set to desired number of cores</span>

<span class="kw">set.seed</span>(<span class="dv">0</span>)</code></pre></div>
<h2 id="model-fitting-setup">Model fitting setup</h2>
<p>To save time, try to load model fitting results from cache. Set to FALSE to refit the models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">use_cache &lt;-<span class="st"> </span><span class="ot">TRUE</span></code></pre></div>
<p>Set default parameters for the ACT-R memory model. These values are used whenever a parameter is held constant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_params &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">s =</span> <span class="fl">.5</span>,
  <span class="dt">decay =</span> <span class="fl">.5</span>,
  <span class="dt">h =</span> <span class="dv">1</span>
)</code></pre></div>
<p>We want to try different splits of the data, ranging from a single window that includes everything to 100 windows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_windows &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>)</code></pre></div>
<h2 id="data-setup">Data setup</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d_f &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="kw">file.path</span>(<span class="st">&quot;..&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;cogpsych_data_formatted.csv&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(d_f)</code></pre></div>
<pre><code>## Classes 'data.table' and 'data.frame':   171219 obs. of  11 variables:
##  $ id                      : chr  &quot;17_18_EN_anon-001_1174_1&quot; &quot;17_18_EN_anon-001_1174_1&quot; &quot;17_18_EN_anon-001_1174_1&quot; &quot;17_18_EN_anon-001_1174_1&quot; ...
##  $ user                    : chr  &quot;17_18_EN_anon-001&quot; &quot;17_18_EN_anon-001&quot; &quot;17_18_EN_anon-001&quot; &quot;17_18_EN_anon-001&quot; ...
##  $ fact                    : chr  &quot;1174_1&quot; &quot;1174_1&quot; &quot;1174_1&quot; &quot;1174_1&quot; ...
##  $ time                    : POSIXct, format: &quot;2017-10-14 14:59:39&quot; &quot;2017-10-14 14:59:47&quot; ...
##  $ presentation_start_time : num  0.00 6.02 6.92e+01 7.73e+05 0.00 ...
##  $ time_since_session_start: num  22.9 28.9 92.1 83.5 38 ...
##  $ time_until_session_end  : num  270 264 201 156 255 ...
##  $ correct                 : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ rt                      : int  6018 4442 3418 4002 4790 2592 2409 4886 1406 5565 ...
##  $ time_between            : num  772370 772370 772370 772370 772370 ...
##  $ time_within             : num  354 348 284 240 327 ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
<p>Each user-fact pair has a single learning sequence associated with it, consisting of three or more trials in one session and the first trial in the next session.</p>
<p>Isolate the last observation per learning sequence (i.e., the one after the between-session interval). This is the observation that the model has to predict, given all prior observations in the sequence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d_last &lt;-<span class="st"> </span>d_f[, .SD[.N], by =<span class="st"> </span>id]
<span class="kw">setorder</span>(d_last, time_between)</code></pre></div>
<p>Define the time windows for all splits of the data (time values are in seconds).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">window_range &lt;-<span class="st"> </span><span class="kw">map_dfr</span>(n_windows, <span class="cf">function</span> (n_w) {

  d_windows &lt;-<span class="st"> </span><span class="kw">copy</span>(d_last)
  
  <span class="cf">if</span> (n_w <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {
    d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span>]
  } <span class="cf">else</span> {
    d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">cut</span>(<span class="kw">log</span>(time_between), <span class="dt">breaks =</span> n_w, <span class="dt">labels =</span> <span class="ot">FALSE</span>)]
  }
  
  <span class="co"># Get the window range(s)</span>
  window_range &lt;-<span class="st"> </span>d_windows[, .(<span class="dt">start =</span> <span class="kw">min</span>(time_between), <span class="dt">end =</span> <span class="kw">max</span>(time_between)), by =<span class="st"> </span>.(window)]
  window_range[, geom_mean <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">sqrt</span>(start<span class="op">*</span>end), by =<span class="st"> </span>.(window)]
  <span class="kw">setorder</span>(window_range, window)
  window_range[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span>window]
  window_range[, n_windows <span class="op">:</span><span class="er">=</span><span class="st"> </span>n_w]

  <span class="kw">return</span> (window_range)
})

window_range</code></pre></div>
<pre><code>##      window       start         end    geom_mean n_windows
##   1:      1      38.363 4605678.952   13292.3911         1
##   2:      1      38.363   13238.121     712.6388         2
##   3:      2   13371.307 4605678.952  248161.1315         2
##   4:      1      38.363    1889.051     269.2019         3
##   5:      2    1902.540   93316.012   13324.3178         3
##  ---                                                      
## 242:     96 2573482.617 2864244.105 2714973.7411       100
## 243:     97 2922474.771 3169998.677 3043721.5966       100
## 244:     98 3280127.598 3525867.324 3400778.5456       100
## 245:     99 3650704.112 3812538.241 3730743.7641       100
## 246:    100 4605678.952 4605678.952 4605678.9520       100</code></pre>
<h1 id="fit-model">Fit model</h1>
<h2 id="optimal-retrieval-threshold">Optimal retrieval threshold</h2>
<p>For each window split, find the optimal retrieval threshold using logistic regression, keeping other parameters constant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">logreg_tau_file &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">&quot;..&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;logistic_regression_tau.csv&quot;</span>)

<span class="cf">if</span> (<span class="op">!</span>use_cache <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">file.exists</span>(logreg_tau_file)) {
  
  lr_tau &lt;-<span class="st"> </span><span class="kw">future_map_dfr</span>(n_windows, <span class="cf">function</span> (n_w) {
    
    d_windows &lt;-<span class="st"> </span><span class="kw">copy</span>(d_last)
    
    <span class="co"># Split the data into windows</span>
    <span class="cf">if</span> (n_w <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {
      d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span>]
    } <span class="cf">else</span> {
      d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">cut</span>(<span class="kw">log</span>(time_between), <span class="dt">breaks =</span> n_w, <span class="dt">labels =</span> <span class="ot">FALSE</span>)]
    }
    
    d_windows_split &lt;-<span class="st"> </span><span class="kw">split</span>(d_windows, d_windows<span class="op">$</span>window)
    
    <span class="co"># Within each quantile, perform logistic regression</span>
    lr_nw &lt;-<span class="st"> </span><span class="kw">imap_dfr</span>(d_windows_split, <span class="cf">function</span> (window, n) {
      
      window[, sequence <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>.N]
      d_window &lt;-<span class="st"> </span>d_f[window[, .(id, window, sequence)], on =<span class="st"> </span>.(id)]
      
      d_seq_list &lt;-<span class="st"> </span><span class="kw">generate_seq_list</span>(d_window)
  
      correct &lt;-<span class="st"> </span><span class="kw">map_int</span>(d_seq_list, <span class="op">~</span>.<span class="op">$</span>correct)
      
      ac &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(d_seq_list, <span class="cf">function</span> (x) {
          <span class="kw">activation</span>(x<span class="op">$</span>time_within, x<span class="op">$</span>time_between, model_params<span class="op">$</span>h, model_params<span class="op">$</span>decay)
      })
      
      m &lt;-<span class="st"> </span><span class="kw">glm</span>(correct <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>((<span class="dv">1</span><span class="op">/</span>model_params<span class="op">$</span>s) <span class="op">*</span><span class="st"> </span>ac),
                 <span class="dt">family =</span> binomial)
      tau &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">coef</span>(m)[[<span class="dv">1</span>]] <span class="op">*</span><span class="st"> </span>model_params<span class="op">$</span>s
    
      <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">n_windows =</span> n_w, <span class="dt">window =</span> n, <span class="dt">tau =</span> tau))
    })
    
    <span class="kw">return</span> (lr_nw)  
  }, <span class="dt">.progress =</span> <span class="kw">interactive</span>())
  
  <span class="kw">setDT</span>(lr_tau)
  <span class="kw">fwrite</span>(lr_tau, logreg_tau_file)
}

lr_tau &lt;-<span class="st"> </span><span class="kw">fread</span>(logreg_tau_file)</code></pre></div>
<h3 id="short-intervals-only">Short intervals only</h3>
<p>For comparison, find the best threshold for reasonably short intervals: 0-10 minutes (Figure 1B in the paper).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">logreg_tau_short_file &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">&quot;..&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;logistic_regression_tau_short.csv&quot;</span>)

<span class="cf">if</span> (<span class="op">!</span>use_cache <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">file.exists</span>(logreg_tau_short_file)) {
  
  d_short &lt;-<span class="st"> </span><span class="kw">copy</span>(d_last)
  d_short &lt;-<span class="st"> </span>d_short[time_between <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span><span class="op">*</span><span class="dv">60</span>]
  d_short[, sequence <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>.N]
  
  d_short &lt;-<span class="st"> </span>d_f[d_short[, .(id, sequence)], on =<span class="st"> </span>.(id)]
  d_short[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span>]
  
  d_seq_list &lt;-<span class="st"> </span><span class="kw">generate_seq_list</span>(d_short)
  
  correct &lt;-<span class="st"> </span><span class="kw">map_int</span>(d_seq_list, <span class="op">~</span>.<span class="op">$</span>correct)
  
  ac &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(d_seq_list, <span class="cf">function</span> (x) {
    <span class="kw">activation</span>(x<span class="op">$</span>time_within, x<span class="op">$</span>time_between, model_params<span class="op">$</span>h, model_params<span class="op">$</span>decay)
  })
  
  m &lt;-<span class="st"> </span><span class="kw">glm</span>(correct <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>((<span class="dv">1</span><span class="op">/</span>model_params<span class="op">$</span>s) <span class="op">*</span><span class="st"> </span>ac),
           <span class="dt">family =</span> binomial)
  tau_short &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">coef</span>(m)[[<span class="dv">1</span>]] <span class="op">*</span><span class="st"> </span>model_params<span class="op">$</span>s
  
  tau_short &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(tau_short)
  <span class="kw">fwrite</span>(tau_short, logreg_tau_short_file)
}

tau_short &lt;-<span class="st"> </span><span class="kw">fread</span>(logreg_tau_short_file)</code></pre></div>
<h2 id="optimal-activation">Optimal activation</h2>
<p>Find the optimal activation per window using logistic regression, keeping other parameters constant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">logreg_activation_file &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">&quot;..&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;logistic_regression_activation.csv&quot;</span>)

<span class="cf">if</span> (<span class="op">!</span>use_cache <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">file.exists</span>(logreg_activation_file)) {
  
  lr_ac &lt;-<span class="st"> </span><span class="kw">future_map_dfr</span>(n_windows, <span class="cf">function</span> (n_w) {
    
    d_windows &lt;-<span class="st"> </span><span class="kw">copy</span>(d_last)
    
    <span class="co"># Split the data into windows</span>
    <span class="cf">if</span> (n_w <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {
      d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span>]
    } <span class="cf">else</span> {
      d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">cut</span>(<span class="kw">log</span>(time_between), <span class="dt">breaks =</span> n_w, <span class="dt">labels =</span> <span class="ot">FALSE</span>)]
    }

    d_windows_split &lt;-<span class="st"> </span><span class="kw">split</span>(d_windows, d_windows<span class="op">$</span>window)
    
    <span class="co"># Find the appropriate tau value</span>
    window_<span class="dv">1</span> &lt;-<span class="st"> </span>d_windows_split[[<span class="dv">1</span>]]
    window_<span class="dv">1</span>[, sequence <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>.N]
    d_window_<span class="dv">1</span> &lt;-<span class="st"> </span>d_f[window_<span class="dv">1</span>[, .(id, window, sequence)], on =<span class="st"> </span>.(id)]
    window_<span class="dv">1</span>_seq_list &lt;-<span class="st"> </span><span class="kw">generate_seq_list</span>(d_window_<span class="dv">1</span>)
    correct &lt;-<span class="st"> </span><span class="kw">map_int</span>(window_<span class="dv">1</span>_seq_list, <span class="op">~</span>.<span class="op">$</span>correct)
    
    ac &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(window_<span class="dv">1</span>_seq_list, <span class="cf">function</span> (x) {
      <span class="kw">activation</span>(x<span class="op">$</span>time_within, x<span class="op">$</span>time_between, model_params<span class="op">$</span>h, model_params<span class="op">$</span>decay)
    })
    
    m &lt;-<span class="st"> </span><span class="kw">glm</span>(correct <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>((<span class="dv">1</span><span class="op">/</span>model_params<span class="op">$</span>s) <span class="op">*</span><span class="st"> </span>ac),
             <span class="dt">family =</span> binomial)
    tau &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">coef</span>(m)[[<span class="dv">1</span>]] <span class="op">*</span><span class="st"> </span>model_params<span class="op">$</span>s
    
    
    <span class="co"># Within each quantile, perform logistic regression to find A</span>
    lr_nw &lt;-<span class="st"> </span><span class="kw">imap_dfr</span>(d_windows_split, <span class="cf">function</span> (window, n) {
      
      window[, sequence <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>.N]
      d_window &lt;-<span class="st"> </span>d_f[window[, .(id, window, sequence)], on =<span class="st"> </span>.(id)]
      
      d_seq_list &lt;-<span class="st"> </span><span class="kw">generate_seq_list</span>(d_window)
      
      correct &lt;-<span class="st"> </span><span class="kw">map_int</span>(d_seq_list, <span class="op">~</span>.<span class="op">$</span>correct)
      
      tau_fixed &lt;-<span class="st"> </span><span class="kw">rep</span>(tau, <span class="kw">length</span>(correct))
      
      m &lt;-<span class="st"> </span><span class="kw">glm</span>(correct <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>((<span class="op">-</span><span class="dv">1</span><span class="op">/</span>model_params<span class="op">$</span>s) <span class="op">*</span><span class="st"> </span>tau_fixed),
               <span class="dt">family =</span> binomial)
      
      ac &lt;-<span class="st"> </span><span class="kw">coef</span>(m)[[<span class="dv">1</span>]] <span class="op">*</span><span class="st"> </span>model_params<span class="op">$</span>s
      
      <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">n_windows =</span> n_w, <span class="dt">window =</span> n, <span class="dt">tau =</span> tau, <span class="dt">activation =</span> ac))
    })
    
    <span class="kw">return</span> (lr_nw)
    
  }, <span class="dt">.progress =</span> <span class="kw">interactive</span>())
  
  <span class="kw">setDT</span>(lr_ac)
  <span class="kw">fwrite</span>(lr_ac, logreg_activation_file)
}

lr_ac &lt;-<span class="st"> </span><span class="kw">fread</span>(logreg_activation_file)</code></pre></div>
<h2 id="optimal-decay">Optimal decay</h2>
<p>Using the optimal activation values determined in the previous step, do a binary search to find the associated decay for each learning sequence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bs_d_indiv_file &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">&quot;..&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;binary_search_indiv_d.csv&quot;</span>)

<span class="cf">if</span> (<span class="op">!</span>use_cache <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">file.exists</span>(bs_d_indiv_file)) {
  
  bs_d_indiv &lt;-<span class="st"> </span><span class="kw">future_map_dfr</span>(n_windows, <span class="cf">function</span> (n_w) {
    
    d_windows &lt;-<span class="st"> </span><span class="kw">copy</span>(d_last)
    
    <span class="co"># Split the data into windows</span>
    <span class="cf">if</span> (n_w <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {
      d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span>]
    } <span class="cf">else</span> {
      d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">cut</span>(<span class="kw">log</span>(time_between), <span class="dt">breaks =</span> n_w, <span class="dt">labels =</span> <span class="ot">FALSE</span>)]
    }

    d_windows_split &lt;-<span class="st"> </span><span class="kw">split</span>(d_windows, d_windows<span class="op">$</span>window)
    
    <span class="co"># Within each quantile, use binary search to find d from A</span>
    d_nw &lt;-<span class="st"> </span><span class="kw">imap_dfr</span>(d_windows_split, <span class="cf">function</span> (window, n) {
      
      window[, sequence <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>.N]
      d_window &lt;-<span class="st"> </span>d_f[window[, .(id, window, sequence)], on =<span class="st"> </span>.(id)]
      
      ac_window &lt;-<span class="st"> </span>lr_ac[n_windows <span class="op">==</span><span class="st"> </span>n_w <span class="op">&amp;</span><span class="st"> </span>window <span class="op">==</span><span class="st"> </span>n, activation]
      
      d_seq_list &lt;-<span class="st"> </span><span class="kw">generate_seq_list</span>(d_window)
      
      d_bs &lt;-<span class="st"> </span><span class="kw">map_dfr</span>(d_seq_list, <span class="cf">function</span> (x) {
        
        d_i &lt;-<span class="st"> </span><span class="dv">1</span>
        d_upper &lt;-<span class="st"> </span><span class="dv">2</span>
        d_lower &lt;-<span class="st"> </span><span class="dv">0</span>
        
        <span class="co"># Binary search</span>
        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {
          ac &lt;-<span class="st"> </span><span class="kw">activation</span>(x<span class="op">$</span>time_within, x<span class="op">$</span>time_between, model_params<span class="op">$</span>h, d_i)
          
          ac_diff &lt;-<span class="st"> </span>ac <span class="op">-</span><span class="st"> </span>ac_window
          
          <span class="cf">if</span> (ac_diff <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) { <span class="co"># Predicted activation too high, so d is too small</span>
            d_lower &lt;-<span class="st"> </span>d_i
          } <span class="cf">else</span> { <span class="co"># Predicted activation too low, so d is too large</span>
            d_upper &lt;-<span class="st"> </span>d_i
          }
          
          d_i &lt;-<span class="st"> </span>(d_lower <span class="op">+</span><span class="st"> </span>d_upper) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
          
        }
        
        <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">n_windows =</span> n_w, <span class="dt">window =</span> n, <span class="dt">id =</span> x<span class="op">$</span>id, <span class="dt">d =</span> d_i))
        
      })
      
      <span class="kw">return</span> (d_bs)

    })
    
    <span class="kw">return</span> (d_nw)
    
  }, <span class="dt">.progress =</span> <span class="kw">interactive</span>())
  
  <span class="kw">setDT</span>(bs_d_indiv)
  <span class="kw">fwrite</span>(bs_d_indiv, bs_d_indiv_file)
}

bs_d_indiv &lt;-<span class="st"> </span><span class="kw">fread</span>(bs_d_indiv_file)</code></pre></div>
<h2 id="optimal-scaling-factor-h">Optimal scaling factor h</h2>
<p>In the same way, do a binary search to find the scaling factor for each learning sequence, based on the optimal activation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bs_h_indiv_file &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">&quot;..&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;binary_search_indiv_h.csv&quot;</span>)

<span class="cf">if</span> (<span class="op">!</span>use_cache <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">file.exists</span>(bs_h_indiv_file)) {
  
  bs_h_indiv &lt;-<span class="st"> </span><span class="kw">future_map_dfr</span>(n_windows, <span class="cf">function</span> (n_w) {
    
    d_windows &lt;-<span class="st"> </span><span class="kw">copy</span>(d_last)
    
    <span class="co"># Split the data into windows</span>
    <span class="cf">if</span> (n_w <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {
      d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span>]
    } <span class="cf">else</span> {
      d_windows[, window <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">cut</span>(<span class="kw">log</span>(time_between), <span class="dt">breaks =</span> n_w, <span class="dt">labels =</span> <span class="ot">FALSE</span>)]
    }
    
    d_windows_split &lt;-<span class="st"> </span><span class="kw">split</span>(d_windows, d_windows<span class="op">$</span>window)
    
    <span class="co"># Within each quantile, use binary search to find h from A</span>
    h_nw &lt;-<span class="st"> </span><span class="kw">imap_dfr</span>(d_windows_split, <span class="cf">function</span> (window, n) {
      
      window[, sequence <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>.N]
      d_window &lt;-<span class="st"> </span>d_f[window[, .(id, window, sequence)], on =<span class="st"> </span>.(id)]
      
      ac_window &lt;-<span class="st"> </span>lr_ac[n_windows <span class="op">==</span><span class="st"> </span>n_w <span class="op">&amp;</span><span class="st"> </span>window <span class="op">==</span><span class="st"> </span>n, activation]
      
      d_seq_list &lt;-<span class="st"> </span><span class="kw">generate_seq_list</span>(d_window)
      
      h_bs &lt;-<span class="st"> </span><span class="kw">map_dfr</span>(d_seq_list, <span class="cf">function</span> (x) {
        
        h_i &lt;-<span class="st"> </span><span class="fl">.5</span>
        h_upper &lt;-<span class="st"> </span><span class="dv">1</span>
        h_lower &lt;-<span class="st"> </span><span class="dv">0</span>
        
        <span class="co"># Binary search</span>
        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {
          ac &lt;-<span class="st"> </span><span class="kw">activation</span>(x<span class="op">$</span>time_within, x<span class="op">$</span>time_between, h_i, model_params<span class="op">$</span>decay)
          
          ac_diff &lt;-<span class="st"> </span>ac <span class="op">-</span><span class="st"> </span>ac_window
          
          <span class="cf">if</span> (ac_diff <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) { <span class="co"># Predicted activation too high, so h is too small</span>
            h_lower &lt;-<span class="st"> </span>h_i
          } <span class="cf">else</span> { <span class="co"># Predicted activation too low, so h is too large</span>
            h_upper &lt;-<span class="st"> </span>h_i
          }
          
          h_i &lt;-<span class="st"> </span>(h_lower <span class="op">+</span><span class="st"> </span>h_upper) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
          
        }
        
        <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">n_windows =</span> n_w, <span class="dt">window =</span> n, <span class="dt">id =</span> x<span class="op">$</span>id, <span class="dt">h =</span> h_i))
        
      })
      
      <span class="kw">return</span> (h_bs)
      
    })
    
    <span class="kw">return</span> (h_nw)
    
  }, <span class="dt">.progress =</span> <span class="kw">interactive</span>())
  
  <span class="kw">setDT</span>(bs_h_indiv)
  <span class="kw">fwrite</span>(bs_h_indiv, bs_h_indiv_file)
}

bs_h_indiv &lt;-<span class="st"> </span><span class="kw">fread</span>(bs_h_indiv_file)</code></pre></div>
<h1 id="session-info">Session info</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.6 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] furrr_0.1.0       future_1.13.0     purrr_0.3.2       data.table_1.13.6
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.6       knitr_1.23       magrittr_2.0.1   tidyselect_1.1.1
##  [5] R6_2.4.0         rlang_0.4.10     fansi_0.4.0      stringr_1.4.0   
##  [9] dplyr_1.0.7      globals_0.12.4   tools_3.6.3      parallel_3.6.3  
## [13] xfun_0.21        utf8_1.1.4       DBI_1.1.0        ellipsis_0.3.2  
## [17] htmltools_0.3.6  yaml_2.2.0       digest_0.6.19    tibble_2.1.3    
## [21] lifecycle_1.0.1  crayon_1.4.1     vctrs_0.3.8      codetools_0.2-16
## [25] glue_1.4.2       evaluate_0.14    rmarkdown_2.6    stringi_1.4.3   
## [29] pillar_1.6.3     compiler_3.6.3   generics_0.1.0   jsonlite_1.6    
## [33] listenv_0.7.0    pkgconfig_2.0.2</code></pre>

</body>
</html>
